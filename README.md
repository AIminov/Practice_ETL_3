Задание 1.3 — Расчёт витрины формы 101

В этом задании реализован расчёт витрины `dm.dm_f101_round_f` (форма 101), которая агрегирует информацию об остатках и оборотах по балансовым счетам второго порядка за месяц.

Отчётная дата передаётся в процедуру как первый день следующего месяца, например:  
для отчёта за январь 2018 → передаётся 2018-02-01

Объяснение скриптов:

00_ddl/00_dm.dm_f101_round_f.sql  
Создаёт витрину `dm.dm_f101_round_f` со структурой, соответствующей описанию в задании

01_procedure/01_dm.fill_f101_round_f.sql  
Создаёт процедуру `dm.fill_f101_round_f(i_OnDate)`  
Выполняет агрегацию остатков и оборотов по счётам, группирует по 5-значным балансовым счетам и рассчитывает все поля формы

01_procedure/02_dm.fill_f101_round_f_CALL.sql  
Выполняет вызов процедуры с датой 2018-02-01 (то есть за январь 2018)

etl_practice_3.sh  
Сценарий запуска всех шагов: создание витрины, создание процедуры и её вызов

Логирование  
Выполнение процедуры логируется в таблицу `logs.etl_proc_log`  
Пишется имя процедуры, дата расчёта, время выполнения и сообщение об успешном завершении

Проверка  
Для проверки результата можно выполнить:

SELECT * FROM dm.dm_f101_round_f ORDER BY ledger_account, characteristic;  
SELECT * FROM logs.etl_proc_log WHERE procedure_name = 'dm.fill_f101_round_f' ORDER BY log_dt DESC;

Проверка логов
SELECT * FROM logs.etl_proc_log
WHERE procedure_name = 'dm.fill_f101_round_f'
ORDER BY log_dt DESC;
